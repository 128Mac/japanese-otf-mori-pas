\documentclass[dvipdfmx,uplatex,9pt]{jsarticle}
%\documentclass[dvipdfmx,uplatex]{utarticle}
%\documentclass[dvipdfmx,uplatex,twocolumn]{utarticle}
%\documentclass[dvipdfmx]{bxjsarticle}

\usepackage[uplatex,jis2004,expert,deluxe,burasage]{otf}
%\usepackage[uplatex,expert,deluxe]{otf}
%\usepackage[uplatex,deluxe]{otf}
\usepackage{otf-mori-pas}
\usepackage{pxrubrica}


\makeatletter

% フォント登録をすっきりに
% family, series, shape, tfmの接頭子
% \DeclareFontShape@nmlexp{Ryumin}{l}{n}{exp}
% \DeclareFontShape@nmlexp{rubyRyumin}{l}{n}{ruby}
% ↓に展開
% \DeclareFontShape{\otf@JYn}{Ryumin}{l}{n}{<->      s * [\utf@sc@le] \otf@pfx@ \brsg@pfx@ expRyuminl\nlck@sfx@-h}{}
% \DeclareFontShape{\otf@JTn}{Ryumin}{l}{n}{<->      s * [\utf@sc@le] \otf@pfx@ \brsg@pfx@ expRyuminl\nlck@sfx@-v}{}
% \DeclareFontShape{\otf@JYn}{rubyRyumin}{l}{n}{<->  s * [\utf@sc@le] \otf@pfx@ rubyRyuminl-h}{}
% \DeclareFontShape{\otf@JTn}{rubyRyumin}{l}{n}{<->  s * [\utf@sc@le] \otf@pfx@ rubyRyuminl-v}{}

\tracingmacros=2 \tracingcommands=3 % マクロ展開と命令実行のトレースを有効に

% \def\DeclareFontShape@nmlexp#1#2#3#4{%
%   \edef\reserved@a{ruby}%
%   \edef\reserved@b{#4}%
%   \ifx\reserved@a\reserved@b%
%     \DeclareFontShape{\otf@JYn}{#1}{#2}{#3}{<->s*[\utf@sc@le]\otf@pfx@ #1#2-h}{}
%     \DeclareFontShape{\otf@JTn}{#1}{#2}{#3}{<->s*[\utf@sc@le]\otf@pfx@ #1#2-v}{}
%   \else
%     \DeclareFontShape{\otf@JYn}{#1}{#2}{#3}{<->s*[\utf@sc@le]\otf@pfx@ \brsg@pfx@ #4#1#2\nlck@sfx@-h}{}
%     \DeclareFontShape{\otf@JTn}{#1}{#2}{#3}{<->s*[\utf@sc@le]\otf@pfx@ \brsg@pfx@ #4#1#2\nlck@sfx@-v}{}
%   \fi
% }

% \DeclareKanjiFamily{\otf@JYn}{Ryumin}{}
% \DeclareKanjiFamily{\otf@JTn}{Ryumin}{}
% % \DeclareFontShape{\otf@JYn}{Ryumin}{m}{n}{<-> s * [\utf@sc@le] \otf@pfx@ \brsg@pfx@ expRyuminm\nlck@sfx@-h}{}
% % \DeclareFontShape{\otf@JTn}{Ryumin}{m}{n}{<-> s * [\utf@sc@le] \otf@pfx@ \brsg@pfx@ expRyuminm\nlck@sfx@-v}{}
% \DeclareFontShape@nmlexp{Ryumin}{m}{n}{exp}
% \tracingmacros=0 \tracingcommands=0 % マクロ展開と命令実行のトレースを有効に

% \DeclareKanjiFamily{\otf@JYn}{ShinGo}{}
% \DeclareKanjiFamily{\otf@JTn}{ShinGo}{}
% % \DeclareFontShape{\otf@JYn}{ShinGo}{m}{n}{<-> s * [\utf@sc@le] \otf@pfx@ \brsg@pfx@ expShinGom\nlck@sfx@-h}{}
% % \DeclareFontShape{\otf@JTn}{ShinGo}{m}{n}{<-> s * [\utf@sc@le] \otf@pfx@ \brsg@pfx@ expShinGom\nlck@sfx@-v}{}
% \DeclareFontShape@nmlexp{ShinGo}{m}{n}{exp}

\makeatother

\makeatletter
% \DeclareKanjiFamily{\otf@JYn}{Ryumin}{}
% \DeclareKanjiFamily{\otf@JTn}{Ryumin}{}
% \DeclareFontShape{\otf@JYn}{Ryumin}{m}{n}{<-> s * [\utf@sc@le] \otf@pfx@ \brsg@pfx@ expRyuminm\nlck@sfx@-h}{}
% \DeclareFontShape{\otf@JTn}{Ryumin}{m}{n}{<-> s * [\utf@sc@le] \otf@pfx@ \brsg@pfx@ expRyuminm\nlck@sfx@-v}{}
% \DeclareKanjiFamily{\otf@JYn}{ShinGo}{}
% \DeclareKanjiFamily{\otf@JTn}{ShinGo}{}
% \DeclareFontShape{\otf@JYn}{ShinGo}{m}{n}{<-> s * [\utf@sc@le] \otf@pfx@ \brsg@pfx@ expShinGom\nlck@sfx@-h}{}
% \DeclareFontShape{\otf@JTn}{ShinGo}{m}{n}{<-> s * [\utf@sc@le] \otf@pfx@ \brsg@pfx@ expShinGom\nlck@sfx@-v}{}

\def\ymnVgo@mapline#1#2#3{%
  \AtBeginDvi{\special{pdf:mapline #1 #2 #3}}%
}

% \ymnVgo@mapline{uphRyuminm-h}{UniJIS-UTF16-H}{A-OTF-RyuminPr6N-Medium.otf}
% \ymnVgo@mapline{uphRyuminm-v}{UniJIS-UTF16-V}{A-OTF-RyuminPr6N-Medium.otf}
% \ymnVgo@mapline{otf-cjRyuminm-h}{Identity-H}{A-OTF-RyuminPr6N-Medium.otf}
% \ymnVgo@mapline{otf-cjRyuminm-v}{Identity-V}{A-OTF-RyuminPr6N-Medium.otf}

% \ymnVgo@mapline{uphShinGom-h}{UniJIS-UTF16-H}{A-OTF-ShinGoPr6N-Medium.otf}
% \ymnVgo@mapline{uphShinGom-v}{UniJIS-UTF16-V}{A-OTF-ShinGoPr6N-Medium.otf}
% \ymnVgo@mapline{otf-cjShinGom-h}{Identity-H}{A-OTF-ShinGoPr6N-Medium.otf}
% \ymnVgo@mapline{otf-cjShinGom-v}{Identity-V}{A-OTF-ShinGoPr6N-Medium.otf}

\makeatother

% https://zrbabbler.hatenablog.com/entry/20140823/1408809426

\def\setFontAllAtr#1#2#3{%
\kanjifamily{#1}\kanjiseries{#2}\kanjishape{#3}\selectfont}

% \def\test#1#2#3#4{\noindent{\setFontAllAtr{#1}{#2}{#3}\makebox[12zw][l]{#4}%
%     あいうアーり――１２３、“葛祇辻鷗”%
%     森\mpUTF{9DD7}外、百\mpUTF{9592}、\mpUTF{9AD9}島屋、%
%     \mpCID{7652}飾区の\mpCID{13706}野家☃}\par}

\rubyfontsetup{\rubyfamily}

\def\test#1#2#3#4{\noindent{\kanjifamily{#1}\kanjiseries{#2}\kanjishape{#3}\selectfont%
    \makebox[11zw][l]{#4}%
    あいうアーりし――１２、“葛祇辻鷗”%
    「森\UTF{9DD7}外」百\UTF{9592}、%
    \jruby[h]{{\UTF{9AD9}}島屋}{たか|しま|や}、%
    \CID{7652}飾区の\CID{13706}野家☃\ajKuroMaru*{01}%
%    \ajTsumesuji2{1}\ajTsumesuji2{2}%
  }\par}


\begin{document}\tracingonline=1 % トレースを端末にも出力

\tracingmacros=1 \tracingcommands=1 % マクロ展開と命令実行のトレースを有効に
\makeatletter
\utf@sc@le \otf@pfx@ \brsg@pfx@ expRyuminl\nlck@sfx@-h
\makeatother
\tracingmacros=0 \tracingcommands=0 % マクロ展開と命令実行のトレースを有効に

\kanjifamily{Ryumin}\kanjiseries{m}\kanjishape{n}\selectfont Ryumin m n あア亜

\tracingmacros=1 \tracingcommands=1 % マクロ展開と命令実行のトレースを有効に
\kanjifamily{Ryumin}\selectfont Ryumin m n あア亜
\tracingmacros=0 \tracingcommands=0 % マクロ展開と命令実行のトレースを有効に

\kanjifamily{ShinGo}\selectfont ShinGo m n あア亜


こんにちは，\LaTeX ①☃
%こんにちは，\LaTeX 

わかった！これは？なんと⁉え

\noindent\null
\tracingmacros=2 \tracingcommands=3 % マクロ展開と命令実行のトレースを有効に
\setFontAllAtr{rubyRyumin}{l}{n} rubyRyumin l n あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\tracingmacros=0 \tracingcommands=0 % マクロ展開と命令実行のトレースを有効に

\setFontAllAtr{Ryumin}{l}{n} Ryumin l n あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{Ryumin}{r}{n} Ryumin r n あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{Ryumin}{m}{n} Ryumin m n あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{Ryumin}{b}{n} Ryumin b n あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{Ryumin}{eb}{n} Ryumin eb n あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{Ryumin}{h}{n} Ryumin h n あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{Ryumin}{eh}{n} Ryumin eh n あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{Ryumin}{u}{n} Ryumin u n あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{Ryumin}{l}{o} Ryumin l o あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{Ryumin}{r}{o} Ryumin r o あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{Ryumin}{m}{o} Ryumin m o あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{Ryumin}{b}{o} Ryumin b o あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{Ryumin}{eb}{o} Ryumin eb o あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{Ryumin}{h}{o} Ryumin h o あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{Ryumin}{eh}{o} Ryumin eh o あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{Ryumin}{u}{o} Ryumin u o あア亜①☃わか――！葛芦辻？なんと⁉えりい\\

\noindent\null
\setFontAllAtr{HiraMin}{w2}{n} HiraMin w2 n あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{HiraMin}{w3}{n} HiraMin w3 n あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{HiraMin}{w4}{n} HiraMin w4 n あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{HiraMin}{w5}{n} HiraMin w5 n あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{HiraMin}{w6}{n} HiraMin w6 n あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{HiraMin}{w7}{n} HiraMin w7 n あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{HiraMin}{w8}{n} HiraMin w8 n あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{HiraMin}{w2}{o} HiraMin w2 o あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{HiraMin}{w3}{o} HiraMin w3 o あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{HiraMin}{w4}{o} HiraMin w4 o あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{HiraMin}{w5}{o} HiraMin w5 o あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{HiraMin}{w6}{o} HiraMin w6 o あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{HiraMin}{w7}{o} HiraMin w7 o あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{HiraMin}{w8}{o} HiraMin w8 o あア亜①☃わか――！葛芦辻？なんと⁉えりい\\

\noindent\null
\setFontAllAtr{ShinGo}{l}{n} ShinGo l n あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{ShinMGo}{l}{n} ShinMGo l n あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{HiraKaku}{w3}{n} HiraKaku w3 n あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{HiraMaru}{w4}{n} HiraMaru w4 n あア亜①☃わか――！葛芦辻？なんと⁉えりい\\
\setFontAllAtr{TBkoin}{m}{n} TBkoin m n あア亜①☃わか――！葛芦辻？なんと⁉えりい\\

\test{rubyRyumin}{l}{n}{リュウミンLルビ}
\test{Ryumin}{l}{n}{リュウミンL}
\test{Ryumin}{r}{n}{リュウミンR}
\test{Ryumin}{m}{n}{リュウミンM}
\test{Ryumin}{b}{n}{リュウミンB}
\test{Ryumin}{eb}{n}{リュウミンEB}
\test{Ryumin}{h}{n}{リュウミンH}
\test{Ryumin}{eh}{n}{リュウミンEH}
\test{Ryumin}{u}{n}{リュウミンU}
\test{Ryumin}{l}{o}{リュウミンオールドL}
\test{Ryumin}{r}{o}{リュウミンオールドR}
\test{Ryumin}{m}{o}{リュウミンオールドM}
\test{Ryumin}{b}{o}{リュウミンオールドB}
\test{Ryumin}{eb}{o}{リュウミンオールドEB}
\test{Ryumin}{h}{o}{リュウミンオールドH}
\test{Ryumin}{eh}{o}{リュウミンオールドEH}
\test{Ryumin}{u}{o}{リュウミンオールドU}

\test{ShinGo}{el}{n}{新ゴEL}
\test{ShinGo}{l}{n}{新ゴL}
\test{ShinGo}{r}{n}{新ゴRL}
\test{ShinGo}{m}{n}{新ゴM}
\test{ShinGo}{db}{n}{新ゴDB}
\test{ShinGo}{b}{n}{新ゴB}
\test{ShinGo}{h}{n}{新ゴH}
\test{ShinGo}{u}{n}{新ゴU}
\test{ShinMGo}{l}{n}{新丸ゴL}
\test{ShinMGo}{r}{n}{新丸ゴR}
\test{ShinMGo}{m}{n}{新丸ゴM}
\test{ShinMGo}{db}{n}{新丸ゴDB}
\test{ShinMGo}{b}{n}{新丸ゴB}
\test{ShinMGo}{h}{n}{新丸ゴH}
\test{ShinMGo}{u}{n}{新丸ゴU}

\test{HiraMin}{w2}{n}{ヒラギノ明朝w2}
\test{HiraMin}{w3}{n}{ヒラギノ明朝w3}
\test{HiraMin}{w4}{n}{ヒラギノ明朝w4}
\test{HiraMin}{w5}{n}{ヒラギノ明朝w5}
\test{HiraMin}{w6}{n}{ヒラギノ明朝w6}
\test{HiraMin}{w7}{n}{ヒラギノ明朝w7}
\test{HiraMin}{w8}{n}{ヒラギノ明朝w8}
\test{HiraMin}{w2}{o}{ヒラギノ明朝w2＋游築}
\test{HiraMin}{w3}{o}{ヒラギノ明朝w3＋游築}
\test{HiraMin}{w4}{o}{ヒラギノ明朝w4＋游築}
\test{HiraMin}{w5}{o}{ヒラギノ明朝w5＋游築}
\test{HiraMin}{w6}{o}{ヒラギノ明朝w6＋游築}
\test{HiraMin}{w7}{o}{ヒラギノ明朝w7＋游築}
\test{HiraMin}{w8}{o}{ヒラギノ明朝w8＋游築}

\test{HiraKaku}{w0}{n}{ヒラギノ角ゴw0}
\test{HiraKaku}{w1}{n}{ヒラギノ角ゴw1}
\test{HiraKaku}{w2}{n}{ヒラギノ角ゴw2}
\test{HiraKaku}{w3}{n}{ヒラギノ角ゴw3}
\test{HiraKaku}{w4}{n}{ヒラギノ角ゴw4}
\test{HiraKaku}{w5}{n}{ヒラギノ角ゴw5}
\test{HiraKaku}{w6}{n}{ヒラギノ角ゴw6}
\test{HiraKaku}{w7}{n}{ヒラギノ角ゴw7}
\test{HiraKaku}{w8}{n}{ヒラギノ角ゴw8}
\test{HiraKaku}{w9}{n}{ヒラギノ角ゴw9}

\test{HiraMaru}{w2}{n}{ヒラギノ丸ゴw2}
\test{HiraMaru}{w3}{n}{ヒラギノ丸ゴw3}
\test{HiraMaru}{w4}{n}{ヒラギノ丸ゴw4}
\test{HiraMaru}{w5}{n}{ヒラギノ丸ゴw5}
\test{HiraMaru}{w6}{n}{ヒラギノ丸ゴw6}
\test{HiraMaru}{w8}{n}{ヒラギノ丸ゴw8}

\test{TBkoin}{m}{n}{TB古印}


\kanjifamily{hmc}\kanjiseries{l}\selectfont hmc l あア亜
あいうアーり――１２３、“葛祇辻鷗” 森\UTF{9DD7}外、百\UTF{9592}、\UTF{9AD9}島屋、\CID{7652}飾区の\CID{13706}野家☃\ajKuroMaru*{01}\ajTsumesuji2{12}

\kanjifamily{hmc}\kanjiseries{m}\selectfont hmc m あア亜
あいうアーり――１２３、“葛祇辻鷗” 森\UTF{9DD7}外、百\UTF{9592}、\UTF{9AD9}島屋、\CID{7652}飾区の\CID{13706}野家☃\ajKuroMaru*{01}\ajTsumesuji2{12}

\kanjifamily{hmc}\kanjiseries{bx}\selectfont hmc bx あア亜
あいうアーり――１２３、“葛祇辻鷗” 森\UTF{9DD7}外、百\UTF{9592}、\UTF{9AD9}島屋、\CID{7652}飾区の\CID{13706}野家☃\ajKuroMaru*{01}\ajTsumesuji2{12}

%\kanjifamily{hmc}\kanjiseries{l}\selectfont hmc l あア亜

\kanjifamily{hgt}\kanjiseries{m}\selectfont hgt m あア亜
あいうアーり――１２３、“葛祇辻鷗” 森\UTF{9DD7}外、百\UTF{9592}、\UTF{9AD9}島屋、\CID{7652}飾区の\CID{13706}野家☃\ajKuroMaru*{01}\ajTsumesuji2{12}

\kanjifamily{hgt}\kanjiseries{bx}\selectfont hgt bx あア亜
あいうアーり――１２３、“葛祇辻鷗” 森\UTF{9DD7}外、百\UTF{9592}、\UTF{9AD9}島屋、\CID{7652}飾区の\CID{13706}野家☃\ajKuroMaru*{01}\ajTsumesuji2{12}

\kanjifamily{hgt}\kanjiseries{eb}\selectfont hgt eb あア亜
あいうアーり――１２３、“葛祇辻鷗” 森\UTF{9DD7}外、百\UTF{9592}、\UTF{9AD9}島屋、\CID{7652}飾区の\CID{13706}野家☃\ajKuroMaru*{01}\ajTsumesuji2{12}

%\kanjifamily{hgt}\kanjiseries{eb}\selectfont hgt eb あア亜

\kanjifamily{mg}\kanjiseries{m}\selectfont mg m あア亜
あいうアーり――１２３、“葛祇辻鷗” 森\UTF{9DD7}外、百\UTF{9592}、\UTF{9AD9}島屋、\CID{7652}飾区の\CID{13706}野家☃\ajKuroMaru*{01}\ajTsumesuji2{12}

\end{document}
